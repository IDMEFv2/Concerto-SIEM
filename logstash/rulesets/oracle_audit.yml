ruleset:
  name: oracle_audit_parsing
  field: "[Attachment][RawLog][Content][message]"
  predicate:
    operator: in
    operands:
      - operator: constant
        operands: "Oracle Audit"
      - operator: variable
        operands: "[Attachment][RawLog][Content][message]"
  rules:
    - id: 130001
      pattern: "LENGTH: %{NOTSPACE} SESSIONID:\\[%{INT:sessionId}\\] %{NOTSPACE} ENTRYID:.+ STATEMENT:\\[\\d+\\] \\S+ USERID:\\[\\d+\\] \"%{DATA:[Attachment][RawLog][Content][user][target][name]}\" USERHOST:\\[\\d+\\] \"%{IPORHOST:[Attachment][RawLog][Content][host][address]}\" TERMINAL:\\[\\d+\\] %{NOTSPACE} ACTION:\\[\\d+\\] %{NOTSPACE} RETURNCODE:\\[\\d+\\] \"0\" COMMENT\\$TEXT:\\[\\d+\\] \"Authenticated by: %{DATA}; Client address: \\(ADDRESS=\\(PROTOCOL=%{DATA:[Attachment][RawLog][Content][network][transport]}\\)\\(HOST=%{IPORHOST:[Attachment][RawLog][Content][source][address]}\\)\\(PORT=%{POSINT:[Attachment][RawLog][Content][source][port]:int}\\)\\)\" OS\\$USERID:\\[\\d+\\] \"%{USER:[Attachment][RawLog][Content][client][user][name]}\" DBID:\\[\\d+\\] \\S+ PRIV\\$USED:\\[\\d\\] %{NOTSPACE}"
      
    - id: 130002
      pattern: "LENGTH: \\S+ SESSIONID:\\[\\d+\\] \\S+ ENTRYID:\\[\\d+\\] \\S+ USERID:\\[\\d+\\] \"%{DATA:[Attachment][RawLog][Content][user][target][name]}\" ACTION:\\[\\d+\\] \\S+ RETURNCODE:\\[\\d+\\] \"0\" LOGOFF\\$PREAD:\\[\\d+\\] \\S+ LOGOFF\\$LREAD:\\[\\d+\\] \\S+ LOGOFF\\$LWRITE:\\[\\d+\\] \\S+ LOGOFF\\$DEAD:\\[\\d+\\] \\S+ DBID:\\[\\d+\\] \\S+ SESSIONCPU:\\[\\d+\\] \\S+"

    - id: 130003
      pattern: "LENGTH : \\S+ ACTION :\\[\\d+\\] 'CONNECT' DATABASE USER:\\[\\d+\\] '%{DATA}' PRIVILEGE :\\[\\d+\\] 'SYSDBA' CLIENT USER:\\[\\d+\\] '%{DATA:[Attachment][RawLog][Content][user][target][name]}' CLIENT TERMINAL:\\[\\d+\\] '%{DATA}' STATUS:\\[\\d+\\] '0' DBID:\\[\\d+\\] \\S+"

    - id: 130004
      pattern: "LENGTH : \\S+ ACTION :\\[\\d+\\] '(?<data>.+)' DATABASE USER:\\[\\d+\\] '%{DATA}' PRIVILEGE :\\[\\d+\\] '%{DATA}' CLIENT USER:\\[\\d+\\] '%{USER:[Attachment][RawLog][Content][user][target][name]}' CLIENT TERMINAL:\\[\\d+\\] '%{DATA}' STATUS:\\[\\d+\\] '0' DBID:\\[\\d+\\] \\S+"

    - id: 130005
      pattern: "LENGTH: \\S+ SESSIONID:\\[\\d+\\] \\S+ ENTRYID:\\[\\d+\\] \\S+ STATEMENT:\\[\\d+\\] \\S+ USERID:\\[\\d+\\] \"%{DATA:[Attachment][RawLog][Content][user][target][name]}\" USERHOST:\\[\\d+\\] \"%{IPORHOST:[Attachment][RawLog][Content][host][address]}\" TERMINAL:\\[\\d+\\] %{NOTSPACE} ACTION:\\[\\d+\\] %{NOTSPACE} RETURNCODE:\\[\\d+\\] \"1031\" OBJ\\$NAME:\\[\\d+\\] \\S+ OS\\$USERID:\\[\\d+\\] \"%{USER:[Attachment][RawLog][Content][client][user][name]}\" DBID:\\[\\d+\\] \\S+"

