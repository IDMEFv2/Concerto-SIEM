ruleset:
  name: ldap_edirectory_parsing
  field: "[Attachment][RawLog][Content][message]"
  predicate:
    operator: regex
    operands:
      - operator: variable
        operands: "[Attachment][RawLog][Content][message]"
      - operator: constant
        operands: "^\\d+ (AUTH|LDAP): \\[\\d{4}/\\d{2}/\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d+\\]"
  rules:
    - id: 25700
      pattern: "AUTH: \\[%{YEAR}/%{MONTHNUM}/%{MONTHDAY} %{HOUR}:?%{MINUTE}(?::?%{SECOND})\\]\\s\\[%{DATA:[Attachment][RawLog][Content][user][target][name]}\\]\\s+<\\.(?<Name1>.+)\\.(?<Name2>[^\\.]+)\\.(?<Name3>[^\\.]+)\\.(?<Name4>[^\\.]+)\\.>\\s+LocalLoginRequest\\. Error\\s+success,\\sconn:\\s+%{INT:number}"
    - id: 25701
      pattern: "LDAP: \\[%{YEAR}/%{MONTHNUM}/%{MONTHDAY} %{HOUR}:?%{MINUTE}(?::?%{SECOND})\\]\\s+Illegal ndsname\\s\"%{USER:[Attachment][RawLog][Content][user][target][name]}\"\\sin\\s(?<path>[^,]+),\\s+err\\s=\\s\\d+"
    - id: 25702
      pattern: "AUTH: \\[%{YEAR}/%{MONTHNUM}/%{MONTHDAY} %{HOUR}:?%{MINUTE}(?::?%{SECOND})\\]\\s\\[%{USER:[Attachment][RawLog][Content][user][target][name]}\\]\\s+<\\.(?<Name1>.+)\\.(?<Name2>[^\\.]+)\\.(?<Name3>[^\\.]+)\\.(?<Name4>[^\\.]+)\\.>\\s+LocalLoginRequest\\. Error\\s+failed\\sauthentication\\s\\(-%{INT:Size}\\),\\sconn:\\s\\d+"

