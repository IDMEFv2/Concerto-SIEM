ruleset:
  name: keepalived_parsing
  field: "[Attachment][RawLog][Content][message]"
  predicate:
    operator: in
    operands:
      - operator: constant
        operands: "Keepalived_vrrp"
      - operator: constant
        operands: "Keepalived"
      - operator: variable
        operands: "[Attachment][RawLog][Content][process][name]"
  rules:
    - id: 23201
      pattern: "Stopping Keepalived %{NOTSPACE:desc}"
    - id: 23202
      pattern: "Starting VRRP child process, pid=%{NOTSPACE:pid}"
    - id: 23203
      pattern: "VRRP_Instance\\((?<data>.+)\\) Entering MASTER STATE"
    - id: 23204
      pattern: "VRRP_Instance\\((?<data>.+)\\) Entering FAULT STATE"
    - id: 23205
      pattern: "Kernel is reporting: interface %{NOTSPACE:interface} DOWN"

