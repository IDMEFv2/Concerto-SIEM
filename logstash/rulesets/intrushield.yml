ruleset:
  name: intrushield_parsing
  field: "[Attachment][RawLog][Content][message]"
  predicate:
    operator: equals
    operands:
      - operator: variable
        operands: "[Attachment][RawLog][Content][process][name]"
      - operator: constant
        operands: "SyslogFaultForwarder"
  rules:
    - id: 24901
      pattern: "Fault : (.*):created:(?<desc>.*):\\d+:.*:.*:.*:Port: (.*):Critical.*Down"
      samples:
        - "Oct 19 16:52:49 60.2.2.31 SyslogFaultForwarder: Fault : Link failure:created:I-2600-2:1006:Sensor interface level:2004-10-19 04:52:49 CEST:Sent by sensor:Port: 1A:Critical:Link failure:Port: 1A:Down:"
    - id: 24902
      pattern: "Fault : (.*):created:(?<desc>.*):\\d+:.*:Sensor unreachable:"
      samples:
        - "Oct 19 17:15:19 60.2.2.31 SyslogFaultForwarder: Fault : Sensor unreachable:created:I-2600-2:1006:Sensor level:2004-10-19 05:15:17 CEST:Generated by Manager:Command Channel:Critical:Sensor unreachable:Command Channel:DISCONNECTED:"
    - id: 24903
      pattern: "Fault : (.*):created:(?<desc>.*):\\d+:.*:Sensor just PowerUp OR Reboot:"
    - id: 24904
      pattern: "Fault : (.*):created:(?<desc>.*):\\d+:.*:Sensor reports alert channel as down:"
